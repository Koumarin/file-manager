[gd_scene load_steps=4 format=2]

[ext_resource path="res://scn/icon-container.tscn" type="PackedScene" id=1]
[ext_resource path="res://scn/file-tree.tscn" type="PackedScene" id=2]

[sub_resource type="GDScript" id=1]
script/source = "extends Control

signal directory_changed(directory)

onready var directory := Directory.new()

func _ready() -> void:
	if directory.open('/') != OK:
		printerr('Can\\'t open directory!')
		return
	emit_signal('directory_changed', directory)

func change_directory(path: String) -> int:
	var err := directory.change_dir(path)
	emit_signal('directory_changed', directory)
	return err

func open_file(path: String, args := '') -> int:
	print('Opening file: ', path)
	return OK

func _on_icon_opened(icon) -> void:
	var path: String = icon.get_file_path()
	
	print('opening ', path)
	
	if icon.is_directory:
		change_directory(path)
	else:
		open_file(path)

func _on_FileTree_directory_selected(path) -> void:
	change_directory(path)
"

[node name="Main" type="Control"]
anchor_right = 1.0
anchor_bottom = 1.0
script = SubResource( 1 )

[node name="Panel" type="Panel" parent="."]
anchor_right = 1.0
anchor_bottom = 1.0
mouse_filter = 1
size_flags_horizontal = 3

[node name="HSplitContainer" type="HSplitContainer" parent="Panel"]
anchor_right = 1.0
anchor_bottom = 1.0
mouse_filter = 1
split_offset = -253

[node name="FileTree" parent="Panel/HSplitContainer" instance=ExtResource( 2 )]

[node name="IconContainer" parent="Panel/HSplitContainer" instance=ExtResource( 1 )]
anchor_right = 0.0
anchor_bottom = 0.0
margin_left = 265.0
margin_right = 1024.0
margin_bottom = 600.0
[connection signal="directory_changed" from="." to="Panel/HSplitContainer/IconContainer" method="_on_directory_changed"]
[connection signal="directory_selected" from="Panel/HSplitContainer/FileTree" to="." method="_on_FileTree_directory_selected"]
[connection signal="icon_opened" from="Panel/HSplitContainer/IconContainer" to="." method="_on_icon_opened"]
